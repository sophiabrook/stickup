<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Examples</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
<script src="jquery.min.js"></script>
<style>
	.header,.main,.footer{
		width: 1000px;
		margin: 0 auto;
	}
	.header{
		height: 50px;
		background: brown;
	}
	.main{
		height: 300px;
	}
	.main:after{
		clear: both;
		display: block;
		content: '';

	}
	.content{
		
		height: 300px;
		float: left;
		width: 100%;
	}
	.content-main{
		margin-left: 210px;
		background: #eee;
		height: 300px;
	}
	.sidebar{
		background: pink;
		height: 300px;
		float: left;
		width: 200px;
		margin-left: -100%;
	}
	
	.footer{
		height: 50px;
		background: yellow;
	}
	.wrap{
		margin-bottom: 20px;
	}
</style>
</head>
<body>
<div class="wrap">
    <div class="header">header</div>
    <div class="main">
		<div class="content">
			<div class="content-main">content-main</div>
		</div>
		<div class="sidebar">sidebar</div>
    </div>
    <div class="footer">footer</div>
</div>

 <div class="wrap">
    <div class="header">header</div>
    <div class="main">
		<div class="content">
			<div class="content-main">content-main</div>
		</div>
		<div class="sidebar">sidebar</div>
    </div>
    <div class="footer">footer</div>
</div>

<div class="wrap">
    <div class="header">header</div>
    <div class="main">
		<div class="content">
			<div class="content-main">content-main</div>
		</div>
		<div class="sidebar">sidebar</div>
    </div>
    <div class="footer">footer</div>
</div>
<script>
jQuery.fn.stickUp =function(){
	var $cur = this,
		curH = $cur.height(),
		curW = $cur.width(),
		offsetTop = $cur.offset().top,
		offsetLeft = $cur.offset().left;

		var $clone = $cur.clone().css({display:'none',visibility:'hideen'}).insertBefore($cur)
	$(window).on('scroll',function(){
		var scrollTop = $(this).scrollTop()
		if(scrollTop>=offsetTop){ 
		    if(!isFixed()){
		      setFixed()
		    }
		  }else{
		    if(isFixed()){
		      unsetFixed()
		    }
		  }
	})
	function isFixed(){
	  return $cur.data('data-fixed') //初始值为false,
	}
	function setFixed(){
	  $cur.data('data-fixed',true)
	  $cur.css({
	    position:'fixed',
	    width:curW,
	    height:curH,
	    left:offsetLeft,
	    // top:offsetTop,
	    top:0,
	    'z-index':999
	  })
	  $clone.show()
	}
	function unsetFixed(){
	  $cur.data('data-fixed',false)
	  $cur.removeAttr('style')
	  $clone.hide()
	}
}
$('.header').each(function(idx){
	$(this).stickUp()
})
</script>
</body>
</html>
